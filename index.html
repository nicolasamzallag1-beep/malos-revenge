<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Malo's Revenge</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bangers&family=Oxanium:wght@600;800;900&display=swap" rel="stylesheet">

<style>
:root{
  --pink:#ff4fd8; --cyan:#33e6ff; --lime:#44ff9a; --gold:#ffd34f;
  --bg:#060818; --glass:rgba(255,255,255,.12);
}
html,body{margin:0;height:100%;background:radial-gradient(circle at 30% 20%,#1a1f55,#060818 70%);font-family:Oxanium,sans-serif;color:#fff;overflow:hidden;cursor:crosshair}
#game{position:relative;width:100vw;height:100vh}
canvas{position:absolute;inset:0}

/* HUD */
#hud{position:absolute;top:14px;left:14px;display:flex;gap:10px;z-index:10}
.hud{background:var(--glass);backdrop-filter:blur(12px);border-radius:14px;padding:8px 12px;border:1px solid rgba(255,255,255,.2)}
.hud span{display:block;font-size:11px;letter-spacing:.14em;text-transform:uppercase;opacity:.8}
.hud b{font-size:26px}

/* Combo */
#combo{position:absolute;left:50%;top:45%;transform:translate(-50%,-50%);font-family:Bangers;font-size:80px;letter-spacing:.08em;opacity:0;pointer-events:none;text-shadow:0 0 18px var(--pink),0 0 28px var(--cyan)}
#combo.show{animation:combo .9s ease-out forwards}
@keyframes combo{0%{opacity:0;transform:translate(-50%,-50%) scale(.6) rotate(-10deg)}20%{opacity:1;transform:translate(-50%,-50%) scale(1.2) rotate(6deg)}80%{opacity:1}100%{opacity:0;transform:translate(-50%,-50%) scale(.9)}}

/* Finger overlay */
.finger{
 position:absolute; z-index:50; font-size:72px; font-family:system-ui;
 animation:finger .6s ease-out forwards; pointer-events:none;
 filter:drop-shadow(0 8px 20px rgba(0,0,0,.6));
}
@keyframes finger{
 0%{transform:scale(.4) rotate(-20deg);opacity:0}
 20%{transform:scale(1.2) rotate(10deg);opacity:1}
 70%{transform:scale(1)}
 100%{transform:scale(.7) translateY(-20px);opacity:0}
}

/* Start */
#start{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:16px;z-index:20;background:linear-gradient(180deg,rgba(6,8,24,.7),rgba(6,8,24,.9))}
#start h1{font-size:64px;letter-spacing:.08em;margin:0;text-shadow:0 0 22px var(--pink)}
#start p{opacity:.85}
#start button{font-family:Oxanium;font-weight:900;letter-spacing:.1em;padding:14px 24px;border-radius:18px;border:1px solid rgba(255,255,255,.25);background:var(--glass);color:#fff;cursor:pointer}

/* End */
#end{position:absolute;inset:0;display:none;flex-direction:column;justify-content:center;align-items:center;gap:14px;z-index:30;background:rgba(6,8,24,.9)}
#end h2{font-size:48px;margin:0}
#end button{padding:12px 22px;border-radius:14px;border:none;font-weight:900;cursor:pointer}
</style>
</head>
<body>
<div id="game">
  <canvas id="c"></canvas>
  <div id="hud">
    <div class="hud"><span>Score</span><b id="score">0</b></div>
    <div class="hud"><span>Temps</span><b id="time">60</b></div>
  </div>
  <div id="combo"></div>
  <div id="start"><h1>MALO'S REVENGE</h1><p>Hit â€¢ Combo â€¢ Repeat</p><button id="play">PLAY</button></div>
  <div id="end"><h2>FIN</h2><div id="final"></div><button onclick="location.reload()">REJOUER</button></div>
</div>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const timeEl = document.getElementById('time');
const comboEl = document.getElementById('combo');

function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
addEventListener('resize',resize);resize();

let score=0, time=60, combo=0, running=false;

const targets=[];
const projectiles=[];

function spawn(){
  targets.push({
    x:Math.random()*(innerWidth-140)+70,
    y:Math.random()*(innerHeight-300)+120,
    r:60,
    vx:(Math.random()*2-1)*2,
    vy:(Math.random()*2-1)*2
  });
}

function throwWine(x,y){
  const sx=innerWidth/2, sy=innerHeight-60;
  const dx=x-sx, dy=y-sy;
  projectiles.push({x:sx,y:sy,vx:dx*2,vy:dy*2,life:1});
}

function showFinger(x,y){
  const f=document.createElement('div');
  f.className='finger';
  f.textContent='ðŸ–•';
  f.style.left=(x-20)+'px';
  f.style.top=(y-40)+'px';
  document.body.appendChild(f);
  setTimeout(()=>f.remove(),600);
}

function loop(dt){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  targets.forEach(t=>{
    t.x+=t.vx; t.y+=t.vy;
    if(t.x<60||t.x>innerWidth-60) t.vx*=-1;
    if(t.y<100||t.y>innerHeight-200) t.vy*=-1;
    ctx.beginPath(); ctx.arc(t.x,t.y,t.r,0,Math.PI*2);
    ctx.strokeStyle='white'; ctx.lineWidth=4; ctx.stroke();
  });

  for(let i=projectiles.length-1;i>=0;i--){
    const p=projectiles[i];
    p.vy+=1200*dt; // ARC LÃ‰GER
    p.x+=p.vx*dt;
    p.y+=p.vy*dt;
    p.life-=dt;

    ctx.font='36px system-ui'; ctx.fillText('ðŸ·',p.x,p.y);

    targets.forEach((t,ti)=>{
      if(Math.hypot(p.x-t.x,p.y-t.y)<t.r){
        targets.splice(ti,1);
        projectiles.splice(i,1);
        score+=10; combo++;
        scoreEl.textContent=score;
        showFinger(t.x,t.y);
        if(combo>=3){ comboEl.textContent='COMBO x'+combo; comboEl.classList.add('show'); setTimeout(()=>comboEl.classList.remove('show'),900); }
      }
    });

    if(p.life<=0) projectiles.splice(i,1);
  }

  if(running) requestAnimationFrame(ts=>loop(1/60));
}

canvas.addEventListener('click',e=>{ if(running) throwWine(e.clientX,e.clientY) });

function start(){
  running=true; score=0; combo=0; time=60;
  scoreEl.textContent=0; timeEl.textContent=60;
  targets.length=0; for(let i=0;i<4;i++) spawn();
  setInterval(()=>{ if(!running)return; time--; timeEl.textContent=time; if(time<=0){running=false;document.getElementById('end').style.display='flex';document.getElementById('final').textContent='Score : '+score}},1000);
  loop();
}

document.getElementById('play').onclick=()=>{document.getElementById('start').style.display='none';start()}
</script>
</body>
</html>